<div class="admin-container">
  <!-- Sidebar réutilisable -->
  <app-sidebar
    [isSidebarCollapsed]="isSidebarCollapsed"
    [isMobileOpen]="isMobileOpen"
    [activeSection]="activeSection"
    [currentUser]="currentUser"
    (sectionChange)="onSectionChange($event)"
    (toggleSidebar)="onToggleSidebar()"
    (toggleMobileSidebar)="onToggleMobileSidebar()"
    (logout)="onLogout()"
  ></app-sidebar>

  <!-- Overlay pour mobile -->
  <div
    class="sidebar-overlay"
    [class.active]="isMobileOpen"
    (click)="onToggleMobileSidebar()"
  ></div>

  <!-- Main Content -->
  <main class="admin-main" [class.expanded]="isSidebarCollapsed">
    <!-- Header mobile (uniquement sur mobile) -->
    <div class="mobile-header" *ngIf="isMobileOpen">
      <button
        class="mobile-toggle"
        (click)="onToggleMobileSidebar()"
        aria-label="Toggle Sidebar"
      >
        <i class="fas fa-bars"></i>
      </button>
      <h1>{{ getSectionTitle(activeSection) }}</h1>
    </div>

    <!-- Dashboard Section -->
    <section *ngIf="activeSection === 'dashboard'" class="section-content">
      <div class="dashboard-section">
        <div class="dashboard-header">
          <h1>Tableau de bord administrateur</h1>
          <p>Vue d'ensemble de votre application médicale</p>
        </div>
        
        <!-- Cartes de statistiques principales -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon primary">
              <i class="fas fa-users"></i>
            </div>
            <div class="stat-info">
              <h3>{{ statistics.totalUsers }}</h3>
              <p>Utilisateurs total</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon secondary">
              <i class="fas fa-user-md"></i>
            </div>
            <div class="stat-info">
              <h3>{{ statistics.totalDoctors }}</h3>
              <p>Médecins</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon success">
              <i class="fas fa-procedures"></i>
            </div>
            <div class="stat-info">
              <h3>{{ statistics.totalPatients }}</h3>
              <p>Patients</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon warning">
              <i class="fas fa-stethoscope"></i>
            </div>
            <div class="stat-info">
              <h3>{{ Object.keys(statistics.specialities).length }}</h3>
              <p>Spécialités</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon info">
              <i class="fas fa-calendar-day"></i>
            </div>
            <div class="stat-info">
              <h3>{{ quickStats.appointmentsToday }}</h3>
              <p>RDV aujourd'hui</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon accent">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-info">
              <h3>{{ quickStats.activeAppointments }}</h3>
              <p>RDV actifs</p>
            </div>
          </div>
        </div>

        <!-- Actions rapides -->
        <div class="quick-actions">
          <div class="section-header">
            <h2>Actions rapides</h2>
          </div>
          <div class="actions-list">
            <button
              class="action-btn primary"
              (click)="setActiveSection('users')"
            >
              <i class="fas fa-user-plus"></i>
              <span>Gérer les utilisateurs</span>
            </button>
            <button
              class="action-btn secondary"
              (click)="setActiveSection('appointments')"
            >
              <i class="fas fa-calendar-plus"></i>
              <span>Voir les rendez-vous</span>
            </button>
            <button
              class="action-btn success"
              (click)="setActiveSection('reports')"
            >
              <i class="fas fa-chart-line"></i>
              <span>Analyser les rapports</span>
            </button>
            <button class="action-btn warning" (click)="exportData()">
              <i class="fas fa-download"></i>
              <span>Exporter les données</span>
            </button>
          </div>
        </div>

        <!-- Graphiques principaux -->
        <div class="charts-section">
          <div class="section-header">
            <h2>Statistiques visuelles</h2>
          </div>
          <div class="charts-grid">
            <!-- Graphique répartition des rôles -->
            <div class="chart-card">
              <h3>Répartition des utilisateurs</h3>
              <div class="chart-container">
                <canvas
                  baseChart
                  [data]="roleChartData"
                  [labels]="roleChartLabels"
                  [type]="roleChartType"
                  [options]="chartOptions"
                >
                </canvas>
              </div>
            </div>

            <!-- Graphique spécialités -->
            <div class="chart-card">
              <h3>Médecins par spécialité</h3>
              <div class="chart-container">
                <canvas
                  baseChart
                  [data]="specialityChartData"
                  [labels]="specialityChartLabels"
                  [type]="specialityChartType"
                  [options]="chartOptions"
                >
                </canvas>
              </div>
            </div>

            <!-- Graphique activité récente -->
            <div class="chart-card full-width">
              <h3>Activité des rendez-vous (7 derniers jours)</h3>
              <div class="chart-container">
                <canvas
                  baseChart
                  [data]="activityChartData"
                  [labels]="activityChartLabels"
                  [type]="activityChartType"
                  [options]="activityChartOptions"
                >
                </canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Rendez-vous récents et actions rapides -->
        <div class="quick-actions-section">
          <div class="actions-grid">
            <!-- Rendez-vous récents -->
            <div class="recent-appointments">
              <div class="section-header">
                <h2>Rendez-vous à venir</h2>
                <button class="view-all-btn" (click)="viewAllAppointments()">
                  Voir tout
                </button>
              </div>
              <div class="appointments-list">
                <div
                  *ngFor="let appointment of recentAppointments"
                  class="appointment-card"
                >
                  <div class="appointment-info">
                    <div class="patient-name">
                      {{ appointment.patientName }}
                    </div>
                    <div class="doctor-name">
                      Dr. {{ appointment.doctorName }}
                    </div>
                    <div class="appointment-time">
                      {{ getFormattedDate(appointment.date) }} à
                      {{ appointment.time }}
                    </div>
                  </div>
                  <div
                    class="appointment-status"
                    [class]="'status-' + appointment.status"
                  >
                    {{ getStatusDisplay(appointment.status) }}
                  </div>
                </div>
                <div *ngIf="recentAppointments.length === 0" class="no-data">
                  Aucun rendez-vous à venir
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Autres sections -->
    <section *ngIf="activeSection === 'users'" class="section-content">
      <app-users-management></app-users-management>
    </section>

    <section *ngIf="activeSection === 'appointments'" class="section-content">
      <app-appointments-management></app-appointments-management>
    </section>

    <section *ngIf="activeSection === 'reports'" class="section-content">
      <app-reports></app-reports>
    </section>

    <!-- Ajouter d'autres sections selon les menus -->
    <section *ngIf="activeSection === 'settings'" class="section-content">
      <h2>Paramètres système</h2>
      <p>Section des paramètres en cours de développement...</p>
    </section>
  </main>
</div>